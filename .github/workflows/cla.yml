name: 📝 CLA Assistant

on:
  issue_comment:
    types: [created]
  pull_request_target:
    types: [opened, closed, synchronize]

jobs:
  cla:
    name: 📝 CLA Check
    runs-on: ubuntu-latest
    if: github.event_name == 'pull_request_target' || (github.event_name == 'issue_comment' && contains(github.event.comment.body, 'recheck'))
    
    steps:
      - name: 📝 CLA Assistant
        if: github.event_name == 'pull_request_target' || contains(github.event.comment.body, 'I have read the CLA Document and I hereby sign the CLA')
        uses: contributor-assistant/github-action@v2.3.0
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          # Store signatures in a private gist
          PERSONAL_ACCESS_TOKEN: ${{ secrets.CLA_PERSONAL_ACCESS_TOKEN }}
        with:
          # Path to the CLA document
          path-to-cla-document: 'https://github.com/${{ github.repository }}/blob/main/CLA.md'
          # Custom message for new contributors
          custom-notsigned-prcomment: |
            Thank you for your contribution! 🎉

            Before we can merge your pull request, we need you to sign our Contributor License Agreement (CLA).

            **Please review and sign our CLA by commenting:**
            ```
            I have read the CLA Document and I hereby sign the CLA
            ```

            ℹ️ **What is a CLA?**
            A CLA (Contributor License Agreement) is a legal document that grants us permission to use and distribute your contributions. It protects both you and the project.

            📋 **CLA Document**: https://github.com/${{ github.repository }}/blob/main/CLA.md

            Once you sign the CLA, this check will automatically pass and your PR can be reviewed. Thanks for contributing to HeadlessX! 🚀
          # Custom message for signed contributors  
          custom-allsigned-prcomment: |
            ✅ **CLA Signed**

            All contributors have signed the CLA. Thank you for contributing to HeadlessX! 🎉
          # Signature message
          custom-pr-sign-comment: 'I have read the CLA Document and I hereby sign the CLA'
          # Lock pull request after merging
          lock-pullrequest-aftermerge: false
          # Use remote repository for CLA document
          remote-organization-name: '${{ github.repository_owner }}'
          remote-repository-name: 'headlessx'
          # Create a detailed signature
          create-file-commit-with-usersignature: true
          # Branch protection
          create-file-commit-with-usersignature-branch: 'cla-signatures'